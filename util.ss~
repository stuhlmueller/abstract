         (define (identity x) x)

         (define (all-equal? lst)
           (all (map (lambda (itm) (equal? (first lst) itm)) (rest lst))))

         (define (all-assoc alist key)
           (filter (lambda (entry) (equal? (first entry) key)) alist))

         (define (more-than-one lst)
           (> (length lst) 1))

         (define (curry fun . const-args)
           (lambda args
             (apply fun (append const-args args))))

         (define (all lst)
           (if (null? lst)
               #t
               (and (first lst)
                    (all (rest lst)))))

         (define (max-take lst n)
           (if (<= (length lst) n)
               lst
               (take lst n)))
         (define (sexp-replace old new sexp)
           (if (list? sexp)
               (map (curry sexp-replace old new) sexp)
               (if (equal? sexp old) new sexp)))

         (define (sexp-search pred? func sexp)
           (if (list? sexp)
               (map (curry sexp-search pred? func) sexp)
               (if (pred? sexp) (func sexp) sexp)))


